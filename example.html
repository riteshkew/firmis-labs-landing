import React, { useState, useEffect } from 'react';
import { 
  ArrowRight, 
  ChevronRight, 
  Terminal, 
  Box, 
  Layers, 
  Database, 
  ArrowUpRight, 
  Cpu, 
  Shield, 
  Zap, 
  FileText,
  Check,
  X
} from 'lucide-react';

// --- Shared Components ---

const SectionHeader = ({ label, title, className = "" }) => (
  <div className={`mb-12 ${className}`}>
    <div className="font-mono text-[#0d9488] text-xs uppercase tracking-widest mb-4">
      {label}
    </div>
    <h2 className="font-heading text-3xl md:text-4xl font-medium text-[#0f172a]">
      {title}
    </h2>
  </div>
);

const Button = ({ children, variant = 'primary', onClick, icon: Icon, className = "" }) => {
  const baseStyles = "px-6 py-3 rounded-md font-medium text-sm transition-all flex items-center gap-2 group";
  const variants = {
    primary: "bg-[#0f172a] text-white hover:bg-[#334155]",
    secondary: "text-[#64748b] border border-[#e2e8f0] hover:border-[#cbd5e1] hover:text-[#0f172a] bg-transparent",
    text: "text-[#0f172a] hover:text-[#0d9488] border-b border-[#0f172a] hover:border-[#0d9488] rounded-none px-0 py-1"
  };

  return (
    <button onClick={onClick} className={`${baseStyles} ${variants[variant]} ${className}`}>
      {children}
      {Icon && <Icon className="w-4 h-4 group-hover:translate-x-1 transition-transform" />}
    </button>
  );
};

// --- View Components ---

const HomeView = ({ setView }) => (
  <>
    {/* Hero */}
    <section className="pt-40 pb-24 md:pt-52 md:pb-32 px-6">
      <div className="max-w-7xl mx-auto">
        <div className="font-mono text-[#0d9488] text-xs uppercase tracking-widest mb-6">
          Institutional Product Studio
        </div>
        <h1 className="font-heading text-5xl md:text-7xl font-medium leading-[1.1] tracking-tight max-w-4xl mb-8 text-[#0f172a]">
          Precision tools for professionals in underserved markets.
        </h1>
        <p className="font-body text-xl text-[#64748b] max-w-2xl leading-relaxed mb-12">
          We build engineering-led, research-driven SaaS. No features for features' sake. 
          Just clarity, speed, and absolute utility.
        </p>
        
        <div className="flex flex-col sm:flex-row gap-4">
          <Button onClick={() => setView('work')} icon={ArrowRight}>Explore Our Work</Button>
          <Button variant="secondary" onClick={() => setView('philosophy')}>Read the Manifesto</Button>
        </div>
      </div>
    </section>

    <div className="w-full border-t border-[#e2e8f0]" />

    {/* Featured Grid */}
    <section className="py-24 px-6 bg-white">
      <div className="max-w-7xl mx-auto">
        <div className="grid grid-cols-1 md:grid-cols-3 gap-12 lg:gap-24">
          <div className="flex flex-col gap-4">
            <div className="w-10 h-10 border border-[#e2e8f0] rounded-md flex items-center justify-center mb-2">
              <Box className="w-5 h-5 text-[#0d9488]" />
            </div>
            <h3 className="font-heading text-xl font-medium">Anti-Bloat</h3>
            <p className="font-body text-[#64748b] leading-relaxed">
              Most software does too much, poorly. We build focused tools that solve specific institutional problems with surgical precision.
            </p>
          </div>
          <div className="flex flex-col gap-4">
            <div className="w-10 h-10 border border-[#e2e8f0] rounded-md flex items-center justify-center mb-2">
              <Terminal className="w-5 h-5 text-[#0d9488]" />
            </div>
            <h3 className="font-heading text-xl font-medium">Engineering-Led</h3>
            <p className="font-body text-[#64748b] leading-relaxed">
              We don't start with marketing. We start with architecture. Performance and reliability are not features; they are the product.
            </p>
          </div>
          <div className="flex flex-col gap-4">
            <div className="w-10 h-10 border border-[#e2e8f0] rounded-md flex items-center justify-center mb-2">
              <Layers className="w-5 h-5 text-[#0d9488]" />
            </div>
            <h3 className="font-heading text-xl font-medium">Clear Signals</h3>
            <p className="font-body text-[#64748b] leading-relaxed">
              Our interfaces are dense with data but free of noise. Designed for professionals who need to make high-stakes decisions fast.
            </p>
          </div>
        </div>
      </div>
    </section>
  </>
);

const PhilosophyView = () => (
  <section className="pt-40 pb-24 px-6 bg-white min-h-screen">
    <div className="max-w-3xl mx-auto">
      <SectionHeader label="Our Manifesto" title="The pursuit of less, but better." />
      
      <div className="prose prose-lg prose-slate font-body text-[#64748b] leading-relaxed">
        <p className="mb-8 text-xl text-[#0f172a]">
          Modern software has lost its way. It is cluttered with engagement hacks, gamification, and features designed to sell rather than solve. We reject this.
        </p>
        
        <h3 className="font-heading text-2xl font-medium text-[#0f172a] mt-12 mb-4">The Firmis Standard</h3>
        <p className="mb-6">
          We believe professional tools should recede into the background. A freight broker managing 50 shipments an hour does not need animations; they need 50ms query times and keyboard shortcuts. A litigator reviewing 10,000 documents does not need a "friendly" UI; they need information density and absolute accuracy.
        </p>

        <ul className="space-y-6 my-12 border-l-2 border-[#e2e8f0] pl-6">
          <li className="flex flex-col gap-1">
            <span className="font-heading font-medium text-[#0f172a]">01. Speed is the primary feature.</span>
            <span className="text-sm">Latency breaks flow. We engineer for sub-100ms interactions.</span>
          </li>
          <li className="flex flex-col gap-1">
            <span className="font-heading font-medium text-[#0f172a]">02. Data over decoration.</span>
            <span className="text-sm">We maximize the signal-to-noise ratio. No drop shadows. No gradients. Just data.</span>
          </li>
          <li className="flex flex-col gap-1">
            <span className="font-heading font-medium text-[#0f172a]">03. Build for the expert.</span>
            <span className="text-sm">We don't dumb things down. We assume our user is a professional who demands power.</span>
          </li>
        </ul>

        <h3 className="font-heading text-2xl font-medium text-[#0f172a] mt-12 mb-4">Our Methodology</h3>
        <p className="mb-6">
          We embed ourselves in the industries we serve. We sit in logistics dispatch centers. We shadow paralegals. We learn the keyboard shortcuts they use in their legacy terminal emulators, and we respect that muscle memory while upgrading the architecture.
        </p>
        <p>
          We do not build for everyone. We build for the few who do the heavy lifting.
        </p>
      </div>
    </div>
  </section>
);

const WorkView = () => (
  <section className="pt-40 pb-24 px-6 bg-[#fafaf9] min-h-screen">
    <div className="max-w-7xl mx-auto">
      <SectionHeader label="Product Portfolio" title="Deployed Systems" />

      {/* Product 1: Vectra Dispatch */}
      <div className="bg-white border border-[#e2e8f0] rounded-lg p-8 lg:p-12 mb-16">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-start">
          <div>
             <div className="flex items-center gap-3 mb-6">
                <span className="font-mono text-xs px-2 py-1 bg-[#f1f5f9] rounded text-[#334155] border border-[#e2e8f0]">v2.4.0</span>
                <span className="font-mono text-xs text-[#0d9488]">Logistics / Freight</span>
              </div>
            <h3 className="font-heading text-4xl font-medium mb-4 text-[#0f172a]">Vectra Dispatch</h3>
            <p className="font-body text-[#64748b] mb-8 leading-relaxed">
               A high-velocity command center for freight brokers. We replaced a fragmented workflow of 4 SaaS tools and Excel with a single, unified interface.
            </p>
            
            <div className="grid grid-cols-2 gap-6 mb-8">
              <div className="flex flex-col gap-2">
                 <Zap className="w-5 h-5 text-[#0d9488]" />
                 <span className="font-medium text-sm">Real-time Websockets</span>
                 <span className="text-xs text-[#94a3b8]">Zero-refresh updates across all clients.</span>
              </div>
              <div className="flex flex-col gap-2">
                 <Terminal className="w-5 h-5 text-[#0d9488]" />
                 <span className="font-medium text-sm">Keyboard First</span>
                 <span className="text-xs text-[#94a3b8]">Full mouse-free navigation support.</span>
              </div>
            </div>

            <Button variant="text" icon={ArrowRight}>Request Case Study</Button>
          </div>

          {/* Abstract UI: Data Table */}
          <div className="bg-[#fafaf9] border border-[#e2e8f0] rounded p-6 overflow-hidden">
             <div className="flex justify-between items-center mb-6 border-b border-[#e2e8f0] pb-4">
                <div className="flex gap-4 text-xs font-mono text-[#64748b]">
                  <span className="text-[#0f172a] font-bold">ALL LOADS</span>
                  <span>PENDING</span>
                  <span>ASSIGNED</span>
                </div>
                <div className="flex gap-2">
                   <div className="w-2 h-2 rounded-full bg-[#22c55e]"></div>
                   <div className="text-[10px] uppercase font-mono text-[#64748b]">Live</div>
                </div>
             </div>
             
             {/* Header Row */}
             <div className="flex gap-4 mb-4 text-[10px] font-mono text-[#94a3b8] uppercase tracking-wider">
               <div className="w-16">ID</div>
               <div className="w-24">Origin</div>
               <div className="w-24">Dest</div>
               <div className="flex-1">Status</div>
               <div className="w-20">Rate</div>
             </div>

             {/* Rows */}
             {[1, 2, 3, 4].map((i) => (
                <div key={i} className="flex gap-4 py-3 border-b border-[#e2e8f0] items-center text-xs font-mono text-[#334155]">
                  <div className="w-16 text-[#0f172a]">#{2900 + i}</div>
                  <div className="w-24">ORD</div>
                  <div className="w-24">LGA</div>
                  <div className="flex-1">
                    <span className={`px-1.5 py-0.5 rounded ${i === 2 ? 'bg-amber-100 text-amber-800' : 'bg-[#f1f5f9] text-[#64748b]'}`}>
                      {i === 2 ? 'DELAYED' : 'IN TRANSIT'}
                    </span>
                  </div>
                  <div className="w-20 text-[#0f172a]">$2,{450 + (i * 10)}</div>
                </div>
             ))}
          </div>
        </div>
      </div>

       {/* Product 2: Firmis Codex */}
      <div className="bg-white border border-[#e2e8f0] rounded-lg p-8 lg:p-12">
        <div className="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
          
           {/* Abstract UI: Document Analysis */}
           <div className="order-2 lg:order-1 bg-[#fafaf9] border border-[#e2e8f0] rounded p-6 relative">
              <div className="absolute top-4 right-4 bg-white border border-[#e2e8f0] px-2 py-1 rounded shadow-sm text-[10px] font-mono text-[#0d9488] flex items-center gap-1">
                 <Shield className="w-3 h-3" />
                 Local Inference
              </div>
              <div className="w-full h-48 bg-white border border-[#e2e8f0] rounded p-4 mb-3">
                 <div className="w-32 h-2 bg-[#e2e8f0] mb-4"></div>
                 <div className="space-y-2">
                    <div className="w-full h-2 bg-[#f1f5f9]"></div>
                    <div className="w-full h-2 bg-[#f1f5f9]"></div>
                    <div className="w-2/3 h-2 bg-[#f1f5f9]"></div>
                    <div className="w-full h-2 bg-[#e2e8f0] bg-opacity-50 relative">
                       <div className="absolute top-0 left-10 w-20 h-full bg-[#0d9488] opacity-20"></div>
                    </div>
                    <div className="w-3/4 h-2 bg-[#f1f5f9]"></div>
                 </div>
              </div>
              <div className="flex gap-3">
                 <div className="flex-1 p-3 bg-white border border-[#e2e8f0] rounded">
                    <div className="text-[10px] font-mono text-[#94a3b8] mb-1">ENTITY</div>
                    <div className="text-xs font-medium text-[#0f172a]">Acme Corp</div>
                 </div>
                 <div className="flex-1 p-3 bg-white border border-[#e2e8f0] rounded">
                    <div className="text-[10px] font-mono text-[#94a3b8] mb-1">DATE</div>
                    <div className="text-xs font-medium text-[#0f172a]">Oct 12, 2023</div>
                 </div>
              </div>
           </div>

           <div className="order-1 lg:order-2">
             <div className="flex items-center gap-3 mb-6">
                <span className="font-mono text-xs px-2 py-1 bg-[#f1f5f9] rounded text-[#334155] border border-[#e2e8f0]">Beta</span>
                <span className="font-mono text-xs text-[#0d9488]">Legal / Discovery</span>
              </div>
            <h3 className="font-heading text-4xl font-medium mb-4 text-[#0f172a]">Firmis Codex</h3>
            <p className="font-body text-[#64748b] mb-8 leading-relaxed">
               Deterministic extraction for civil litigation. We turn unstructured PDF dumps into strict, queryable SQL databases without sending data to the cloud.
            </p>
            
            <ul className="space-y-3 mb-8 text-sm text-[#334155]">
               <li className="flex items-center gap-3">
                  <Check className="w-4 h-4 text-[#0d9488]" />
                  <span>100% Local LLM Processing (Privacy First)</span>
               </li>
               <li className="flex items-center gap-3">
                  <Check className="w-4 h-4 text-[#0d9488]" />
                  <span>Automatic Timeline Generation</span>
               </li>
               <li className="flex items-center gap-3">
                  <Check className="w-4 h-4 text-[#0d9488]" />
                  <span>Citation Linking to Original Source</span>
               </li>
            </ul>

            <Button variant="text" icon={ArrowRight}>View Technical Spec</Button>
          </div>
        </div>
      </div>
    </div>
  </section>
);

const ContactView = () => (
  <section className="pt-40 pb-24 px-6 bg-white min-h-screen">
    <div className="max-w-2xl mx-auto">
      <SectionHeader label="Inquire" title="Start a conversation." />
      <p className="text-[#64748b] mb-12 leading-relaxed">
        We operate with a small team and take on limited engagements. If you have a complex problem in an unsexy industry, we want to hear from you.
      </p>

      <form className="space-y-8" onSubmit={(e) => e.preventDefault()}>
        <div className="space-y-6">
          <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div className="flex flex-col gap-2">
              <label className="text-xs font-mono uppercase tracking-wider text-[#64748b]">Name</label>
              <input type="text" className="w-full border-b border-[#e2e8f0] py-2 focus:outline-none focus:border-[#0f172a] transition-colors bg-transparent text-[#0f172a]" placeholder="Enter full name" />
            </div>
            <div className="flex flex-col gap-2">
              <label className="text-xs font-mono uppercase tracking-wider text-[#64748b]">Email</label>
              <input type="email" className="w-full border-b border-[#e2e8f0] py-2 focus:outline-none focus:border-[#0f172a] transition-colors bg-transparent text-[#0f172a]" placeholder="Enter work email" />
            </div>
          </div>
          
          <div className="flex flex-col gap-2">
            <label className="text-xs font-mono uppercase tracking-wider text-[#64748b]">Organization</label>
            <input type="text" className="w-full border-b border-[#e2e8f0] py-2 focus:outline-none focus:border-[#0f172a] transition-colors bg-transparent text-[#0f172a]" placeholder="Company or Institution name" />
          </div>

          <div className="flex flex-col gap-2">
            <label className="text-xs font-mono uppercase tracking-wider text-[#64748b]">The Problem</label>
            <textarea rows={4} className="w-full border border-[#e2e8f0] rounded-md p-4 focus:outline-none focus:border-[#0f172a] transition-colors bg-[#fafaf9] text-[#0f172a] resize-none" placeholder="Briefly describe the inefficiency or workflow you are looking to solve." />
          </div>
        </div>

        <div className="pt-4">
          <Button variant="primary" icon={ArrowUpRight} className="w-full md:w-auto justify-center">Submit Inquiry</Button>
        </div>
        
        <p className="text-xs text-[#94a3b8] mt-6">
          We typically respond within 48 hours. We value your privacy and NDA workflows are available upon request.
        </p>
      </form>
    </div>
  </section>
);

// --- Main App Component ---

const FirmisWebsite = () => {
  const [view, setView] = useState('home');
  const [scrolled, setScrolled] = useState(false);
  const [mobileMenuOpen, setMobileMenuOpen] = useState(false);

  useEffect(() => {
    const handleScroll = () => setScrolled(window.scrollY > 50);
    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  // Scroll to top on view change
  useEffect(() => {
    window.scrollTo(0, 0);
    setMobileMenuOpen(false);
  }, [view]);

  const navLinks = [
    { id: 'home', label: 'Index' },
    { id: 'philosophy', label: 'Philosophy' },
    { id: 'work', label: 'Work' },
    { id: 'contact', label: 'Contact' }
  ];

  return (
    <div className="min-h-screen bg-[#fafaf9] text-[#0f172a] selection:bg-[#0d9488] selection:text-white font-sans antialiased">
       <style>{`
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Instrument+Sans:wght@400;500;600&family=Inter:wght@400;500&display=swap');
        
        :root {
          --font-heading: 'Instrument Sans', sans-serif;
          --font-body: 'Inter', sans-serif;
          --font-mono: 'IBM Plex Mono', monospace;
        }

        .font-heading { font-family: var(--font-heading); }
        .font-body { font-family: var(--font-body); }
        .font-mono { font-family: var(--font-mono); }
      `}</style>

      {/* Navigation */}
      <nav className={`fixed w-full top-0 z-50 transition-all duration-300 ${scrolled ? 'bg-[#fafaf9]/95 backdrop-blur-sm border-b border-[#e2e8f0]' : 'bg-transparent border-transparent'}`}>
        <div className="max-w-7xl mx-auto px-6 h-20 flex items-center justify-between">
          <button onClick={() => setView('home')} className="flex items-center gap-3 z-50 relative">
            <div className="w-6 h-6 bg-[#0f172a] rounded-sm flex items-center justify-center">
              <div className="w-2 h-2 bg-[#fafaf9] rounded-full" />
            </div>
            <span className="font-heading font-semibold tracking-tight text-lg">Firmis Labs</span>
          </button>

          {/* Desktop Nav */}
          <div className="hidden md:flex items-center gap-8 font-body text-sm text-[#64748b]">
            <button onClick={() => setView('philosophy')} className={`transition-colors ${view === 'philosophy' ? 'text-[#0f172a] font-medium' : 'hover:text-[#0f172a]'}`}>Philosophy</button>
            <button onClick={() => setView('work')} className={`transition-colors ${view === 'work' ? 'text-[#0f172a] font-medium' : 'hover:text-[#0f172a]'}`}>Work</button>
            <button onClick={() => setView('contact')} className={`transition-colors ${view === 'contact' ? 'text-[#0f172a] font-medium' : 'hover:text-[#0f172a]'}`}>Inquire</button>
          </div>

          <div className="hidden md:block">
            <button onClick={() => setView('contact')} className="font-mono text-xs uppercase tracking-wider px-4 py-2 border border-[#e2e8f0] rounded-md hover:bg-[#0f172a] hover:text-white hover:border-[#0f172a] transition-all duration-200">
              Start Project
            </button>
          </div>

          {/* Mobile Menu Toggle */}
          <button className="md:hidden z-50 p-2" onClick={() => setMobileMenuOpen(!mobileMenuOpen)}>
            {mobileMenuOpen ? <X className="w-6 h-6" /> : <div className="space-y-1.5"><div className="w-6 h-0.5 bg-[#0f172a]"></div><div className="w-6 h-0.5 bg-[#0f172a]"></div></div>}
          </button>
        </div>

        {/* Mobile Nav Overlay */}
        {mobileMenuOpen && (
          <div className="fixed inset-0 bg-[#fafaf9] z-40 flex flex-col pt-32 px-6">
             {navLinks.map((link) => (
               <button 
                key={link.id}
                onClick={() => setView(link.id)}
                className="text-left font-heading text-3xl font-medium py-4 border-b border-[#e2e8f0] text-[#0f172a]"
               >
                 {link.label}
               </button>
             ))}
          </div>
        )}
      </nav>

      {/* Main Content Area */}
      <main className="min-h-screen">
        {view === 'home' && <HomeView setView={setView} />}
        {view === 'philosophy' && <PhilosophyView />}
        {view === 'work' && <WorkView />}
        {view === 'contact' && <ContactView />}
      </main>

      {/* Footer */}
      <footer className="bg-white border-t border-[#e2e8f0] py-12 px-6">
        <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-start md:items-center gap-8">
          <div>
            <div className="flex items-center gap-2 mb-4">
              <div className="w-4 h-4 bg-[#0f172a] rounded-sm flex items-center justify-center">
                 <div className="w-1 h-1 bg-[#fafaf9] rounded-full" />
              </div>
              <span className="font-heading font-semibold text-[#0f172a]">Firmis Labs</span>
            </div>
            <p className="font-body text-xs text-[#94a3b8] max-w-xs leading-relaxed">
              Â© 2025 Firmis Labs, Inc. <br/>
              Building for the long haul in London & New York.
            </p>
          </div>

          <div className="flex gap-8 font-mono text-xs text-[#64748b] uppercase tracking-wider">
            <a href="#" className="hover:text-[#0f172a]">Twitter/X</a>
            <a href="#" className="hover:text-[#0f172a]">LinkedIn</a>
            <a href="#" className="hover:text-[#0f172a]">GitHub</a>
            <a href="mailto:hello@firmislabs.com" className="hover:text-[#0f172a]">Email</a>
          </div>
        </div>
      </footer>

    </div>
  );
};

export default FirmisWebsite;
